# 技術仕様

### コア技術

- **言語**: TypeScript 5.8.3（strict mode）
- **Node.js**: 18.0.0以上
- **パッケージマネージャー**: pnpm 9.0.0以上（推奨）
- **Ethereum互換**: EIP-1559（Type 2 トランザクション）
- **暗号化**: secp256k1（viem経由）
- **バリデーション**: Zod 3.25.57

### 主要依存関係

| パッケージ | バージョン | 用途 | 品質特性への貢献 |
|----------|-----------|------|-----------------|
| **viem** | 2.31.0 | Ethereum操作・署名 | 正確性・セキュリティ |
| **commander** | 11.1.0 | CLIフレームワーク | DX（開発者体験） |
| **zod** | 3.25.57 | スキーマバリデーション | 正確性・堅牢性 |

### 開発・品質ツール

#### テスト・検証
| ツール | バージョン | 目的 | 品質特性 |
|--------|-----------|------|----------|
| **Vitest** | 3.2.3 | テストフレームワーク | 正確性 |
| **StrykerJS** | 9.0.1 | 変異テスト | 堅牢性 |
| **dependency-cruiser** | 16.10.3 | アーキテクチャ検証 | 保守性 |

#### コード品質
| ツール | バージョン | 目的 | 品質特性 |
|--------|-----------|------|----------|
| **Biome** | 1.9.4 | リンター・フォーマッター | 保守性・DX |
| **tsup** | 8.5.0 | ビルド（Rust製） | DX |

#### セキュリティ・品質保証
| ツール | 機能 | 品質特性 |
|--------|------|----------|
| **pnpm audit** | 依存関係脆弱性検査 | セキュリティ |
| **Branded Types** | 型レベルセキュリティ | セキュリティ |
| **husky + lint-staged** | Git hooks自動化 | DX・品質保証 |

### アーキテクチャ

#### 4層アーキテクチャ（Layered Architecture）
```
┌─────────────────────────────────────────────┐
│                CLI層 (cli/)        　  　    │  プレゼンテーション層
│             UI・入出力制御                    │  commander.js
├─────────────────────────────────────────────┤
│            アプリケーション層 (core/)          │  ビジネスロジック層
│         ワークフロー制御・調整             　   │  TypeScript, viem
├─────────────────────────────────────────────┤
│              ドメイン層 (types/) 　           │  ドメインモデル層
│         ビジネスルール・データモデル     　      │  Zod, TypeScript
├─────────────────────────────────────────────┤
│           インフラストラクチャ層 (utils/)   　  │  インフラ層
│         横断的関心事・外部リソース     　  　    │  Node.js FS, Logger
└─────────────────────────────────────────────┘
```

#### 選択根拠
- **シンプルさ**: 単一ドメイン（Ethereum署名）に適した複雑度
- **保守性**: 関心事の分離により理解・変更が容易
- **テスト性**: 各層の独立テストが可能
- **過剰設計の回避**: クリーンアーキテクチャより軽量

### パフォーマンス仕様

- **起動時間**: < 1秒
- **署名時間**: < 100ms
- **メモリ使用量**: < 50MB
- **バイナリサイズ**: ~170KB（最適化済み）

### 品質メトリクス

#### コード品質
- **サイクロマティック複雑度**: 目標 < 5（関数あたり）、最大10（例外的ケースのみ）
- **関数長**: 目標 10-20行、最大 30行（コメント・空白を除く）
- **TypeScript strict**: 有効
- **技術的負債**: ゼロ（TODOコメント禁止、コメントアウトコード禁止、重複コード排除）

#### ドキュメンテーションカバレッジ
- **公開API**: 100%カバレッジ
- **JSDoc**: 全エクスポート関数に@param、@returns、@throwsを記述

#### テスト品質
- **テストカバレッジ**: 95%以上（目標）
- **ミューテーションスコア**: 85%以上（Stryker）
- **テスト数**: 466テスト（ユニット・統合）

#### セキュリティ
- **脆弱性**: 0件（本番依存関係）
- **秘密鍵管理**: ファイル権限強制（400/600）
- **入力検証**: Zodによる厳格なバリデーション

### サポートネットワーク

| ネットワーク | チェーンID | 自動RPC | エクスプローラー | 用途 |
|-------------|-----------|---------|-----------------|------|
| **Sepolia** | `11155111` | ✅ | https://sepolia.etherscan.io | テスト |
| **Hoodi** | `560048` | ✅ | https://hoodi.etherscan.io | テスト |
| **Anvil** | `31337` | ✅ | ローカル | 開発 |
